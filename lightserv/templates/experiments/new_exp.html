{% extends "layout.html" %}
{% block content %}
	<h1 align="center">New Request Form</h1>
	 <div class="content-section">

		<form method="POST" action="">
			{{ form.hidden_tag() }}
			<fieldset class="form-group">
				<legend class="border-bottom mb-2 mt-4">Background Info</legend>
				<div class="form-group">
					{% if form.labname.flags.required %}*{% endif %}
					{{ form.labname.label(class="form-control-label") }}
					{% if form.labname.errors %}
						{{ form.labname(class="form-control form-control-lg is-invalid") }}
						<div class="invalid-feedback">
							{% for error in form.labname.errors %}
								<span>{{ error }}</span>
							{% endfor %}
						</div>
					{% else %}
						{{ form.labname(class="form-control form-control-lg") }}
					{% endif %}
				</div>
				<div class="form-group">
					{% if form.correspondence_email.flags.required %}*{% endif %}
					{{ form.correspondence_email.label(class="form-control-label") }}
					{% if form.correspondence_email.errors %}
						{{ form.correspondence_email(class="form-control form-control-lg is-invalid") }}
						<div class="invalid-feedback">
							{% for error in form.correspondence_email.errors %}
								<span>{{ error }}</span>
							{% endfor %}
						</div>
					{% else %}
						{{ form.correspondence_email(class="form-control form-control-lg") }}
					{% endif %}
				</div>
				<div class="form-group">
					{% if form.title.flags.required %}*{% endif %}
					{{ form.title.label(class="form-control-label") }}
					{% if form.title.errors %}
						{{ form.title(class="form-control form-control-lg is-invalid") }}
						<div class="invalid-feedback">
							{% for error in form.title.errors %}
								<span>{{ error }}</span>
							{% endfor %}
						</div>
					{% else %}
						{{ form.title(class="form-control form-control-lg") }}
					{% endif %}
				</div>
				<div class="form-group">
					{% if form.description.flags.required %}*{% endif %}
					{{ form.description.label(class="form-control-label") }}
					{% if form.description.errors %}
						{{ form.description(class="form-control form-control-lg is-invalid") }}
						<div class="invalid-feedback">
							{% for error in form.description.errors %}
								<span>{{ error }}</span>
							{% endfor %}
						</div>
					{% else %}
						{{ form.description(class="form-control form-control-lg") }}
					{% endif %}
				</div>
				<div class="form-group">
					{% if form.species.flags.required %}*{% endif %}
					{{ form.species.label(class="form-control-label mr-2") }}
					{{ form.species(class="form-control form-control-lg border-bottom") }}
				</div>

				<div class="form-group">
					{% if form.number_of_samples.flags.required %}*{% endif %}
					{{ form.number_of_samples.label(class="form-control-label") }}
					{% if form.number_of_samples.errors %}
						{{ form.number_of_samples(class="form-control form-control-lg is-invalid") }}
						<div class="invalid-feedback">
							{% for error in form.number_of_samples.errors %}
								<span>{{ error }}</span>
							{% endfor %}
						</div>
					{% else %}
						{{ form.number_of_samples(class="form-control form-control-lg") }}
					{% endif %}
				</div>

				<div class="form-group">
					{% if form.sample_prefix.flags.required %}*{% endif %}
					{{ form.sample_prefix.label(class="form-control-label") }}
					{% if form.sample_prefix.errors %}
						{{ form.sample_prefix(class="form-control form-control-lg is-invalid") }}
						<div class="invalid-feedback">
							{% for error in form.sample_prefix.errors %}
								<span>{{ error }}</span>
							{% endfor %}
						</div>
					{% else %}
						{{ form.sample_prefix(class="form-control form-control-lg") }}
					{% endif %}
				</div>
				
				<!-- CLEARING section -->
				<hr class='class-3'>
				<legend class='border-bottom'>Clearing Info</legend>
				<div class="custom-control form-control-lg custom-checkbox">
					{{ form.self_clearing(class="custom-control-input") }}
					{{ form.self_clearing.label(class="custom-control-label") }}
				</div>
				<div class="form-group">
					<span> Will clearing protocol be the same for all samples?</span>

					<!-- Change the style of button that was pressed
					 to make it clear to the user -->
					{% if form.samples.data %}
						{% if form.custom_clearing.data == true %}
							{{ form.uniform_clearing_submit(class="btn btn-outline-info mt-2") }}
							{{ form.custom_clearing_submit(class="btn btn-info mt-2") }}
						{% else %}
							{{ form.uniform_clearing_submit(class="btn btn-info mt-2") }}
							{{ form.custom_clearing_submit(class="btn btn-outline-info mt-2") }}
						{% endif %}

					{% else %}
						{{ form.uniform_clearing_submit(class="btn btn-outline-info mt-2") }}
						{{ form.custom_clearing_submit(class="btn btn-outline-info mt-2") }}
					{% endif %}
				</div>

				<div>
					
					
						

					{% for entry in form.samples %}
						{% if form.custom_clearing.data == true %}
					        <legend class="form-control-label">Sample {{ loop.index }}: {{form.sample_prefix.data }}-{{ loop.index }} </legend>
					    {% elif form.custom_clearing.data == false %}
					    	<legend class="form-control-label">Sample {{ loop.index }}: {{form.sample_prefix.data }}-{{ loop.index }} <br/>(Your entries below will apply to all of your samples) </legend>
						{% endif %}
				        <hr>

				        <div class="form-group">
							{% if entry.perfusion_date.flags.required %}*{% endif %}
							{{ entry.perfusion_date.label(class="form-control-label") }}
							{% if entry.perfusion_date.errors %}
								{{ entry.perfusion_date(class="form-control form-control-lg is-invalid") }}
								<div class="invalid-feedback">
									{% for error in entry.perfusion_date.errors %}
										<span>{{ error }}</span>
									{% endfor %}
								</div>
							{% else %}
								{{ entry.perfusion_date(class="form-control form-control-lg") }}
							{% endif %}
						</div>

						<div class="form-group">
							{% if entry.expected_handoff_date.flags.required %}*{% endif %}
							{{ entry.expected_handoff_date.label(class="form-control-label") }}
							{% if entry.expected_handoff_date.errors %}
								{{ entry.expected_handoff_date(class="form-control form-control-lg is-invalid") }}
								<div class="invalid-feedback">
									{% for error in entry.expected_handoff_date.errors %}
										<span>{{ error }}</span>
									{% endfor %}
								</div>
							{% else %}
								{{ entry.expected_handoff_date(class="form-control form-control-lg") }}
							{% endif %}
						</div>

				        <div class="form-group">
							{% if entry.clearing_protocol.flags.required %}*{% endif %}
							{{ entry.clearing_protocol.label(class="form-control-label") }}
							{% if entry.clearing_protocol.errors %}
								{{ entry.clearing_protocol(class="form-control form-control-lg is-invalid") }}
								<div class="invalid-feedback">
									{% for error in entry.clearing_protocol.errors %}
										<span>{{ error }}</span>
									{% endfor %}
								</div>
							{% else %}
								{{ entry.clearing_protocol(class="form-control form-control-lg") }}
							{% endif %}
						</div>

						

						<div class="form-group">
							{% if entry.antibody1.flags.required %}*{% endif %}
							{{ entry.antibody1.label(class="form-control-label") }}
							{% if entry.antibody1.errors %}
								{{ entry.antibody1(class="form-control form-control-lg is-invalid") }}
								<div class="invalid-feedback">
									{% for error in entry.antibody1.errors %}
										<span>{{ error }}</span>
									{% endfor %}
								</div>
							{% else %}
								{{ entry.antibody1(class="form-control form-control-lg") }}
							{% endif %}
						</div>

						<div class="form-group">
							{% if entry.antibody2.flags.required %}*{% endif %}
							{{ entry.antibody2.label(class="form-control-label") }}
							{% if entry.antibody2.errors %}
								{{ entry.antibody2(class="form-control form-control-lg is-invalid") }}
								<div class="invalid-feedback">
									{% for error in entry.antibody2.errors %}
										<span>{{ error }}</span>
									{% endfor %}
								</div>
							{% else %}
								{{ entry.antibody2(class="form-control form-control-lg") }}
							{% endif %}
						</div>
					{% endfor %}
				</div>
			</fieldset>
			<hr class='class-3'>
			<hr class='class-4'>
			<div class="form-group">
				{{ form.submit(class="btn btn-success mt-2") }}
			</div>
	
		</form>
	</div>

<!-- For focusing to a given tag -->
{% if column_name %}
	<script>
	window.onload = function() {
	  document.getElementById("{{column_name}}").focus();
	};
	</script>
{% endif %}
{% endblock content %}