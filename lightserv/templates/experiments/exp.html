{% extends "layout.html" %}
	{% block content %}
		<article class="media content-section">

			<div class="media-body">
				<div class="article-metadata">
				<a class="mr-2">Experiment: {{ exp_contents.fetch1('experiment_id') }}</a>
				
				</div>
				<a class="mr-2" href="{{ url_for('experiments.exp_rawdata',experiment_id=exp_contents.fetch1('experiment_id')) }}" target="_blank">View Your Data</a>
			</div>
			{% if exp_contents.fetch1('username') == session['user'] %}
		        <div>
		            <button type="button" class="btn btn-danger btn-sm m-1" data-toggle="modal" data-target="#deleteModal">Delete</button>
	            </div>
	        {% endif %}
		</article>
		{{ exp_table }}
		<input id = "tableSwapper" type="button"  class="btn btn-sm btn-info mt-1" value="Swap rows and columns"/>
		<!-- Notes Section -->
		<article class="media content-section mt-4">

			<div class="media-body mb-4">
				<div class="article-metadata">
				<a class="mr-2">Notes: </a>
				
				</div>
				{% if exp_contents.fetch1('notes') == "" %}
					No notes yet
				{% else %}
					{{ exp_contents.fetch1('notes') }}
				{% endif %}
			</div>
			{% if exp_contents.fetch1('username') == session['user'] %}
		        <div>
		        	<a class="btn btn-secondary btn-sm mt-1 mb-1" href="{{ url_for('experiments.update_notes', experiment_id=exp_contents.fetch1('experiment_id')) }}">Add/Update Notes</a>
	            </div>
	        {% endif %}
		</article>

		<!-- Modal -->
		  <div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="deleteModalLabel" aria-hidden="true">
		    <div class="modal-dialog" role="document">
		      <div class="modal-content">
		        <div class="modal-header">
		          <h5 class="modal-title" id="deleteModalLabel">Delete Experiment?</h5>

		          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
		            <span aria-hidden="true">&times;</span>
		          </button>
		        </div>
		        <div class="modal-footer">
		          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
		          <form action="{{ url_for('experiments.delete_exp',experiment_id=exp_contents.fetch1('experiment_id')) }}" method="POST">
		            <input class="btn btn-danger" type="submit" value="Delete">
		          </form>
		        </div>
		      </div>
		    </div>
		  </div>

<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>

	<script>
	$("#tableSwapper").click(function(){
    $("table").each(function() {
        var $this = $(this);
        var newrows = [];
        $this.find("tr").each(function(){
            var i = 0;
            $(this).find("td, th").each(function(){
                i++;
                if(newrows[i] === undefined) { newrows[i] = $("<tr></tr>"); }
                if(i == 1)
                    newrows[i].append("<th>" + this.innerHTML  + "</th>");
                else
                    newrows[i].append("<td>" + this.innerHTML  + "</td>");
            });
        });
        $this.find("tr").remove();
        $.each(newrows, function(){
            $this.append(this);
        });
    });
    
    return false;
});
</script>
	{% endblock content %}